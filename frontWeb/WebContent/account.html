<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<style type="text/css">
	#app{margin: auto; margin-top: 60px; padding: 10px;
		 width: 60%; border: 3px solid #8ac007;}
</style>
</head>
<body>
	<div id="app">
		<h1>회원가입</h1>
		<form id="frm">
			<table border="1">
			<tr>
				<td>아이디</td>
				<td>
					<input type="text" id="inputId" size="20">
					<p id="idCheck"></p>
					<button type="button" id="idCheckBtn">중복확인</button>
				</td>
			</tr>
			<tr>
				<td>사용아이디</td>
				<td><input type="text" id="id" name="id" size="20" readonly="readonly"></td>
			</tr>
			<tr>
				<td>패스워드</td>
				<td><input type="text" id="pwd" name="pwd" size="20"></td>
			</tr>
			
			<tr>
				<td>이름</td>
				<td><input type="text" id="name" name="name" size="20"></td>
			</tr>
			<tr>
				<td>이메일</td>
				<td><input type="text" id="email" name="email" size="20"></td>
			</tr>
			
			<tr>
				<td colspan="2">
					<button type="button" id="account">회원가입</button>
				</td>
			</tr>
			</table>
		</form>
	</div>
	
	<script type="text/javascript">
		$(document).ready(function () {
			// 아이디 확인
			$("#idCheckBtn").click(function () {		
				$.ajax({
					url:"http://localhost:3000/getId",
					type:"post",
					data:{"id":$("#inputId").val() },
					success:function( msg ){
						//alert('success');
						if(msg.trim() == 'YES'){
							$("#idCheck").html("사용할 수 있는 아이디입니다");
							$("#id").val( $("#inputId").val() )
						}else{
							$("#idCheck").html("이미 사용중인 아이디입니다");
							$("#inputId").val("");
							$("#inputId").focus();
						}
					},error:function(){
						alert('error');
					}
				});		
			});
			
			// 회원가입
			$("#account").on("click", function () {
				let params = $("#frm").serialize();
				// let params = { id:$("#id").val(), pwd:$("#pwd").val(), name:$("#name").val(), email:$("#email").val() };
				$.ajax({
					url:"http://localhost:3000/addMember",
					type:"post",
					data:params,
					success:function(data){
						// alert("success");
						if(data == "YES"){
							alert('회원가입 성공');
							location.href = "login.html";
						}else{
							alert('회원가입 실패');
						}
					},error:function(){
						alert("error");
					}
				});
			});
		});
	</script>
</body>
</html>